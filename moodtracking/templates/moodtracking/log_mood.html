

    <!-- æäº¤æˆåŠŸæç¤º -->
    <div id="success-message" style="display: none; margin: 20px 0; padding: 10px; background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; border-radius: 5px;">
        Your mood has been saved successfully!
    </div>

    <!-- Mood Slider å’Œ Emoji -->
    <div style="text-align: center; margin-bottom: 20px; margin-top: 40px;">
        <!-- Emoji æ˜¾ç¤º -->
        <div id="emoji-display" style="font-size: 48px; margin-bottom: 10px;">ğŸ˜</div>
        
        <!-- æ¸²æŸ“è¡¨å• -->
        <form id="mood-form" method="POST" action="{% url 'log_mood' %}" style="width: 100%; position: relative;">
            {% csrf_token %}
            
            <!-- æ¸²æŸ“æ»‘å— -->
            {{ form.mood_score }}
            
            <!-- å¿ƒæƒ…æ–‡å­— -->
            <div id="mood-text" style="margin-top: 10px; font-size: 16px; color: #ffb703; margin-bottom: 20px;">Neutral</div>
            
            <!-- æ¸²æŸ“æè¿°è¾“å…¥æ¡† -->
            {{ form.description }}
            
            <!-- æäº¤æŒ‰é’® -->
            <button 
                type="submit" 
                style="margin-top: 10px; float: right; padding: 10px 20px; background-color: var(--theme-color); color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">
                Post
            </button>
        </form>
    </div>

<script>
    // å®šä¹‰å¿ƒæƒ…æ•°æ®ï¼šemoji å’Œæ–‡å­—å¯¹åº”å…³ç³»ï¼Œæ”¯æŒ10æ¡£
    const moodData = {
        1: { emoji: "ğŸ˜­", text: "Extremely Sad" },
        2: { emoji: "ğŸ˜¢", text: "Very Sad" },
        3: { emoji: "ğŸ˜", text: "Sad" },
        4: { emoji: "ğŸ™", text: "A Bit Sad" },
        5: { emoji: "ğŸ˜", text: "Neutral" },
        6: { emoji: "ğŸ™‚", text: "Content" },
        7: { emoji: "ğŸ˜Š", text: "Happy" },
        8: { emoji: "ğŸ˜", text: "Very Happy" },
        9: { emoji: "ğŸ˜„", text: "Excited" },
        10: { emoji: "ğŸ¤©", text: "Extremely Happy" }
    };

    // è·å–æ»‘å—ã€emojiæ˜¾ç¤ºå’Œå¿ƒæƒ…æ–‡å­—å…ƒç´ 
    const moodSlider = document.querySelector('input[name="mood_score"]');
    const emojiDisplay = document.getElementById("emoji-display");
    const moodText = document.getElementById("mood-text");
    const moodForm = document.getElementById("mood-form");

    // æ»‘å—äº‹ä»¶ç›‘å¬ï¼šåŠ¨æ€åˆ‡æ¢ Emoji å’Œæ–‡å­—
    moodSlider.addEventListener("input", () => {
        const moodValue = moodSlider.value;
        emojiDisplay.textContent = moodData[moodValue].emoji;
        moodText.textContent = moodData[moodValue].text;
    });

    // åˆå§‹åŒ–æ˜¾ç¤º
    const initialMood = moodSlider.value;
    emojiDisplay.textContent = moodData[initialMood].emoji;
    moodText.textContent = moodData[initialMood].text;

    // è¡¨å•æäº¤é€šè¿‡AJAXå¤„ç†
    moodForm.addEventListener("submit", async (event) => {
        event.preventDefault(); // é˜»æ­¢é»˜è®¤æäº¤è¡Œä¸º

        const formData = new FormData(moodForm);

        try {
            const response = await fetch(moodForm.action, {
                method: "POST",
                body: formData,
                headers: {
                    "X-Requested-With": "XMLHttpRequest"
                },
            });

            const data = await response.json();

            if (response.ok) {
                // æäº¤æˆåŠŸååˆ·æ–°é¡µé¢
                location.reload();
            } else {
                console.error("Error:", data.errors);
                alert("Failed to save mood. Please try again.");
            }
        } catch (error) {
            console.error("Error:", error);
            alert("Something went wrong. Please try again.");
        }
    });
</script>
